#!/bin/bash
DIR=$(dirname "$BASH_SOURCE")
. "$DIR/../bash/functions"
echo -n 'working...'
{
  # TODO appdir
  DBDIR="$DIR/../db"
  mkdir -p "$DBDIR" && cd "$DBDIR"
} && {
  if [[ -f database.db ]]; then
    echo
    confirm 'Do you really want to clobber the database?' && rm database.db
  fi
} && {
  sqlite3 database.db <<SQL
.read ../src/sql/sqlite/schema.sql
SQL
} && {
  if [[ -f ../src/sql/sqlite/data.sql ]]; then
    sqlite3 database.db <<SQL
.read ../src/sql/sqlite/data.sql
SQL
  fi
} && {
  chmod -R a+w .
} && {
  echo 'done'
}
